/*! Datepicker - v0.1.0 - 2013-05-15
* https://github.com/amazingsurge/jquery-datepicker
* Copyright (c) 2013 amazingSurge; Licensed MIT */
(function(e){var t=e.daypicker=function(s,a){this.el=e(s),this.options=e.extend(!0,{},t.defaults,a),this.format=this.parse_format(this.options.format||"mm/dd/yyyy"),this.namespace=this.options.namespace,this.init()},s={};t.defaults={first_day_of_week:1,mode:"single",calendars:2,date:"today",max:null,min:null,position:"bottom",alwaysShow:!1,selectable:[],lang:"en",views:["days"],format:"yyyy/mm/dd",namespace:"calendar",tpl_wrapper:'<div class="namespace-wrap"></div>',tpl_content:'<div class="namespace"><div class="namespace-head"><span class="namespace-prev"></span><span class="namespace-caption"></span><span class="namespace-next"></span></div><table class="namespace-days"></table><table class="namespace-months"></table><table class="namespace-years"></table></div>',localize:function(e,t){s[e]=t},onRender:function(){return{}},onChange:function(){return!0},onShow:function(){return!0},onBeforeShow:function(){return!0},onHide:function(){return!0}},t.defaults.localize("en",{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],days_short:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],months_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),t.defaults.localize("zh",{days:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],days_short:["日","一","二","三","四","五","六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],months_short:["一","二","三","四","五","六","七","八","九","十","十一","十二"]}),t.prototype={constructor:t,init:function(){var t=this.options.tpl_wrapper.replace(/namespace/g,this.namespace),s=this.options.tpl_content.replace(/namespace/g,this.namespace),a="";if(this.picker=e(t).appendTo("body").on({click:e.proxy(this.click,this)}),"today"!==this.options.date){var i=this.parse_date(this.options.date,this.format);this.default_date=i}else this.default_date=new Date;if(this.selected_date="today"===this.options.date?[new Date]:[new Date(i)],this.current_date="today"===this.options.date?[new Date]:[new Date(i)],"single"===this.options.mode)a+=s,this.current_date[0].setHours(0,0,0,0),this.selected_date[0].setHours(0,0,0,0);else{"range"===this.options.mode?this.options.calendars=2:"multiple"===this.options.mode&&(this.multiple_date=[]);for(var n=0;this.options.calendars>n;n++)a+=s,void 0===this.options.views[n]&&(this.options.views[n]="days"),void 0===this.current_date[n]&&(this.current_date[n]="today"===this.options.date?new Date:new Date(i)),void 0===this.selected_date[n]&&(this.selected_date[n]="today"===this.options.date?new Date:new Date(i)),this.current_date[n].setHours(0,0,0,0),this.selected_date[n].setHours(0,0,0,0)}if(this.picker.append(a),this.view=this.options.views,this.calendar=this.picker.find("."+this.namespace),this.calendar_prev=this.calendar.find("."+this.namespace+"-prev"),this.calendar_caption=this.calendar.find("."+this.namespace+"-caption"),this.calendar_next=this.calendar.find("."+this.namespace+"-next"),this.daypicker=this.calendar.find("."+this.namespace+"-days"),this.monthpicker=this.calendar.find("."+this.namespace+"-months"),this.yearpicker=this.calendar.find("."+this.namespace+"-years"),null!==this.options.min&&(this.min_year=this.getMin().getFullYear(),this.min_month=this.getMin().getMonth()),null!==this.options.max&&(this.max_year=this.getMax().getFullYear(),this.max_month=this.getMax().getMonth()),this.date_update(),"multiple"===this.options.mode){for(var n=0;this.options.calendars>n;n++)this.set_date(this.current_date[n],"month",this.current_month[n]+n);this.date_update()}if("single"===this.options.mode)this.manage_views(0);else for(var n=0;this.options.calendars>n;n++)this.manage_views(n);this.is_input=this.el.is("input"),this.is_input?this.options.alwaysShow===!1?this.el.on({focus:e.proxy(this.show,this)}):this.show():this.el="",this.set_value()},changeOptions:function(e){for(var t in e)this.options[t]=e[t];this.destroy(),this.init()},show:function(){this.picker.fadeIn("normal"),this.picker.show();var t=this;this.position(),this.options.alwaysShow===!1&&e(document).on("mousedown",function(s){0===e(s.target).closest(t.calendar).length&&0===e(s.target).closest(t.el).length&&t.hide()})},hide:function(){var e=this;this.picker.fadeOut("normal",function(){e.picker.hide()})},multipleClear:function(){this.multiple_date=[];for(var e=0;this.options.calendars>e;e++)this.manage_views(e);this.set_value()},getWrap:function(){return this.picker},getInput:function(){return this.el},getDate:function(e){if(void 0===e){if("multiple"===this.options.mode){for(var t=[],s=0;this.multiple_date.length>s;s++)t[s]=new Date(this.multiple_date[s]);return t}return this.selected_date}var a=this.parse_format(e),i=[];if("multiple"===this.options.mode)for(var s=0;this.multiple_date.length>s;s++)i[s]=this.format_date(new Date(this.multiple_date[s]),a);else for(var s=0;this.selected_date.length>s;s++)i[s]=this.format_date(this.selected_date[s],a);return i},getMax:function(){var e,t=this.el.attr("max")||this.options.max,s=this.default_date.getDate();if(t){if("number"==typeof t)e=new Date(this.default_date),e.setDate(s+t);else{if("string"==typeof t){var a=t.match(/[.\/\-\s].*?/);3!==t.split(a).length&&(t=parseInt(t))}e=this.parse_date(t,this.format)}return e}return!1},getMin:function(){var e,t=this.el.attr("min")||this.options.min,s=this.default_date.getDate();if(t){if("number"==typeof t)e=new Date(this.default_date),e.setDate(s-t);else{if("string"==typeof t){var a=t.match(/[.\/\-\s].*?/);3!==t.split(a).length&&(t=parseInt(t))}e=this.parse_date(t,this.format)}return e}return!1},destroy:function(){this.el.removeData("datepicker"),this.getWrap().remove()},position:function(){var e=(window.innerHeight,window.innerWidth,this.picker.outerHeight()),t=this.picker.outerWidth(),s=this.el.offset().top,a=this.el.offset().left,i=this.el.outerHeight(),n=this.el.outerWidth(),r=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,h=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,o=s-r,c=a-h;"top"===this.options.position?this.picker.css({left:c+h,top:o-e+r}):"right"===this.options.position?this.picker.css({left:c+n+h,top:o+r}):"bottom"===this.options.position?this.picker.css({left:c+h,top:o+i+r}):"left"===this.options.position?this.picker.css({left:c-t+h,top:o+r}):"rightTop"===this.options.position?this.picker.css({left:c+n+h,top:o-e+i+r}):"leftTop"===this.options.position&&this.picker.css({left:c-t+h,top:o-e+i+r})},set_value:function(){if("single"===this.options.mode){var e=this.format_date(this.selected_date[0],this.format);this.el.val(e)}else if("range"===this.options.mode){var t=this.format_date(this.selected_date[0],this.format),s=this.format_date(this.selected_date[1],this.format);this.el.val(t+" - "+s)}else if("multiple"===this.options.mode){for(var e,a="",i=0;this.multiple_date.length>i;i++)e=this.format_date(new Date(this.multiple_date[i]),this.format),a+=0===a.length?e:","+e;this.el.val(a)}},set_date:function(e,t,s){switch(t){case"day":e.setDate(s);break;case"month":e.setMonth(s);break;case"year":e.setYear(s)}},str_pad:function(e,t){for(e+="";t>e.length;)e="0"+e;return e},str_concat:function(){for(var e="",t=0;arguments.length>t;t++)e+=arguments[t]+"";return e},parse_format:function(e){var t=e.match(/[.\/\-\s].*?/),s=e.split(/\W+/)||s;if(!s||0===s.length)throw Error("Invalid date format.");return{separator:t,parts:s}},parse_date:function(e,t){var s,a=e.split(t.separator)||a,e=new Date;if(e.setHours(0,0,0,0),a.length===t.parts.length)for(var i=0,n=t.parts.length;n>i;i++){if(s=parseInt(a[i],10)||1,"1"===s)return;switch(t.parts[i]){case"dd":case"d":e.setDate(s);break;case"mm":case"m":e.setMonth(s-1);break;case"yy":e.setFullYear(2e3+s);break;case"yyyy":e.setFullYear(s)}}return e},format_date:function(e,t){var s={d:e.getDate(),m:e.getMonth()+1,yy:(""+e.getFullYear()).substring(2),yyyy:e.getFullYear()};s.dd=(10>s.d?"0":"")+s.d,s.mm=(10>s.m?"0":"")+s.m,e=[];for(var a=0,i=t.parts.length;i>a;a++)e.push(s[t.parts[a]]);return e.join(t.separator)},date_update:function(){if("single"===this.options.mode)this.current_day=[this.current_date[0].getDate()],this.current_month=[this.current_date[0].getMonth()],this.current_year=[this.current_date[0].getFullYear()],this.selected_day=[this.selected_date[0].getDate()],this.selected_month=[this.selected_date[0].getMonth()],this.selected_year=[this.selected_date[0].getFullYear()];else{this.current_day=[],this.current_month=[],this.current_year=[],this.selected_day=[],this.selected_month=[],this.selected_year=[];for(var e=0;this.options.calendars>e;e++)this.current_day[e]=this.current_date[e].getDate(),this.current_month[e]=this.current_date[e].getMonth(),this.current_year[e]=this.current_date[e].getFullYear(),this.selected_day[e]=this.selected_date[e].getDate(),this.selected_month[e]=this.selected_date[e].getMonth(),this.selected_year[e]=this.selected_date[e].getFullYear()}},generate_daypicker:function(e){var t=new Date(this.current_year[e],this.current_month[e]+1,0).getDate(),a=new Date(this.current_year[e],this.current_month[e],2).getDay(),i=new Date(this.current_year[e],this.current_month[e],0).getDate(),n=a-this.options.first_day_of_week,r='<thead><tr class="'+this.namespace+'-week">';if("single"===this.options.mode){var h=this.current_year[0],o=this.current_month[0];null!==this.options.max&&(h>this.max_year?this.calendar_next.addClass(this.namespace+"-blocked"):this.max_year>h?this.calendar_next.removeClass(this.namespace+"-blocked"):o>=this.max_month?this.calendar_next.addClass(this.namespace+"-blocked"):this.calendar_next.removeClass(this.namespace+"-blocked")),null!==this.options.min&&(this.min_year>h?this.calendar_prev.addClass(this.namespace+"-blocked"):h>this.min_year?this.calendar_prev.removeClass(this.namespace+"-blocked"):this.min_month>=o?this.calendar_prev.addClass(this.namespace+"-blocked"):this.calendar_prev.removeClass(this.namespace+"-blocked"))}else if("range"===this.options.mode){var c=(this.current_date[0],this.current_date[1],this.selected_date[0]),l=this.selected_date[1],d=[];e>0?(this.current_year[e]===this.selected_year[e-1]?this.current_month[e]<=this.selected_month[e-1]?this.calendar_prev.eq(e).addClass(this.namespace+"-blocked"):this.calendar_prev.eq(e).hasClass(this.namespace+"-blocked")===!0&&this.calendar_prev.eq(e).removeClass(this.namespace+"-blocked"):this.calendar_prev.eq(e).hasClass(this.namespace+"-blocked")===!0&&this.calendar_prev.eq(e).removeClass(this.namespace+"-blocked"),null!==this.options.max&&(this.current_year[e]>this.max_year?this.calendar_next.eq(e).addClass(this.namespace+"-blocked"):this.current_year[e]<this.max_year?this.calendar_next.eq(e).removeClass(this.namespace+"-blocked"):this.current_month[e]>=this.max_month?this.calendar_next.eq(e).addClass(this.namespace+"-blocked"):this.calendar_next.eq(e).removeClass(this.namespace+"-blocked"))):(this.current_year[e]===this.selected_year[e+1]?this.current_month[e]>=this.selected_month[e+1]?this.calendar_next.eq(e).addClass(this.namespace+"-blocked"):this.calendar_next.eq(e).hasClass(this.namespace+"-blocked")===!0&&this.calendar_next.eq(e).removeClass(this.namespace+"-blocked"):this.calendar_next.eq(e).hasClass(this.namespace+"-blocked")===!0&&this.calendar_next.eq(e).removeClass(this.namespace+"-blocked"),null!==this.options.min&&(this.current_year[e]<this.min_year?this.calendar_prev.eq(e).addClass(this.namespace+"-blocked"):this.current_year[e]>this.min_year?this.calendar_prev.eq(e).removeClass(this.namespace+"-blocked"):this.current_month[e]<=this.min_month?this.calendar_prev.eq(e).addClass(this.namespace+"-blocked"):this.calendar_prev.eq(e).removeClass(this.namespace+"-blocked")))}else if("multiple"===this.options.mode)if(this.calendar_caption.eq(e).addClass(this.namespace+"-blocked"),0===e){var p=this.options.calendars-1;this.calendar_next.eq(e).addClass(this.namespace+"-blocked"),null!==this.options.min&&(this.current_year[e]===this.min_year?this.current_month[e]<=this.min_month?this.calendar_prev.eq(e).addClass(this.namespace+"-blocked"):this.calendar_prev.eq(e).removeClass(this.namespace+"-blocked"):this.current_year[e]<this.min_year?this.calendar_prev.eq(e).addClass(this.namespace+"-blocked"):this.calendar_prev.eq(e).removeClass(this.namespace+"-blocked"))}else e===this.options.calendars-1?(this.calendar_prev.eq(e).addClass(this.namespace+"-blocked"),null!==this.options.max&&(this.current_year[e]===this.max_year?this.current_month[e]>=this.max_month?this.calendar_next.eq(e).addClass(this.namespace+"-blocked"):this.calendar_next.eq(e).removeClass(this.namespace+"-blocked"):this.current_year[e]>this.max_year?this.calendar_next.eq(e).addClass(this.namespace+"-blocked"):this.calendar_next.eq(e).removeClass(this.namespace+"-blocked"))):(this.calendar_prev.eq(e).addClass(this.namespace+"-blocked"),this.calendar_next.eq(e).addClass(this.namespace+"-blocked"));n=0>n?7+n:n,this.manage_header(s[this.options.lang].months[this.current_month[e]]+" "+this.current_year[e],e);for(var p=0;7>p;p++)r+="<th>"+s[this.options.lang].days_short[p]+"</th>";for(r+="</tr></thead>",r+="<tbody><tr>",p=0;42>p;p++){var m=p-n+1;if(p>0&&0===p%7&&(r+="</tr><tr>"),"single"===this.options.mode){var u="";content=0,d=[],n>p?(d[p]=new Date(this.current_year[e],this.current_month[e]-1,i-n+p+1,0,0,0,0),u="otherMonthDay",content=i-n+p+1):p>t+n-1?(d[p]=new Date(this.current_year[e],this.current_month[e]+1,m-t,0,0,0,0),u="otherMonthDay",content=m-t):(d[p]=new Date(this.current_year[e],this.current_month[e],m,0,0,0,0),Date.parse(d[p])==Date.parse(this.selected_date[0])&&(u="is-active"),content=m),null!==this.options.min&&Date.parse(this.getMin())>Date.parse(d[p])&&(u+=" is-untouchable"),null!==this.options.max&&Date.parse(this.getMax())<Date.parse(d[p])&&(u+=" is-untouchable")}else if("range"===this.options.mode){var u="";content=0,d=[],n>p?(d[p]=new Date(this.current_year[e],this.current_month[e]-1,i-n+p+1,0,0,0,0),u="otherMonthDay",0===e?Date.parse(d[p])==Date.parse(c)?u+=" is-active":d[p]>c&&l>=d[p]&&(u+=" in-range"):1===e&&(Date.parse(d[p])==Date.parse(l)?u+=" is-active":d[p]>=c&&l>d[p]?u+=" in-range":c>d[p]&&(u+=" is-untouchable")),null!==this.options.min&&Date.parse(this.getMin())>Date.parse(d[p])&&(u+=" is-untouchable"),null!==this.options.max&&Date.parse(this.getMax())<Date.parse(d[p])&&(u+=" is-untouchable"),content=i-n+p+1):p>t+n-1?(d[p]=new Date(this.current_year[e],this.current_month[e]+1,m-t,0,0,0,0),u="otherMonthDay",0===e?Date.parse(d[p])==Date.parse(c)?u+=" is-active":d[p]>c&&l>=d[p]?u+=" in-range":d[p]>l&&(u+=" is-untouchable"):1===e&&(Date.parse(d[p])==Date.parse(l)?u+=" is-active":d[p]>=c&&l>d[p]&&(u+=" in-range")),null!==this.options.min&&Date.parse(this.getMin())>Date.parse(d[p])&&(u+=" is-untouchable"),null!==this.options.max&&Date.parse(this.getMax())<Date.parse(d[p])&&(u+=" is-untouchable"),content=m-t):(d[p]=new Date(this.current_year[e],this.current_month[e],m,0,0,0,0),0===e?Date.parse(d[p])==Date.parse(c)?u="is-active":d[p]>c&&l>=d[p]?u="in-range":d[p]>l&&(u="is-untouchable"):1===e&&(Date.parse(d[p])==Date.parse(l)?u="is-active":d[p]>=c&&l>d[p]?u="in-range":c>d[p]&&(u="is-untouchable")),null!==this.options.min&&Date.parse(this.getMin())>Date.parse(d[p])&&(u+="is-untouchable"),null!==this.options.max&&Date.parse(this.getMax())<Date.parse(d[p])&&(u+="is-untouchable"),content=m)}else if("multiple"===this.options.mode){var u="";content=0,d=[],n>p?(d[p]=new Date(this.current_year[e],this.current_month[e]-1,i-n+p+1,0,0,0,0),u+=" otherMonthDay",content=i-n+p+1):p>t+n-1?(d[p]=new Date(this.current_year[e],this.current_month[e]+1,m-t,0,0,0,0),u+=" otherMonthDay",content=m-t):(d[p]=new Date(this.current_year[e],this.current_month[e],m,0,0,0,0),content=m);for(var _=0;this.multiple_date.length>_;_++)this.multiple_date[_]===Date.parse(d[p])&&(u+=" is-active");null!==this.options.min&&Date.parse(this.getMin())>Date.parse(d[p])&&(u+=" is-untouchable"),null!==this.options.max&&Date.parse(this.getMax())<Date.parse(d[p])&&(u+=" is-untouchable")}r+='<td class="'+u+'">'+content+"</td>"}r+="</tr>",this.daypicker.eq(e).html(r)},generate_monthpicker:function(e){this.manage_header(this.current_year[e],e);var t=s[this.options.lang].months_short;if("single"===this.options.mode){var a=[];null!==this.options.max&&(this.current_year[0]>=this.max_year?this.calendar_next.eq(e).addClass(this.namespace+"-blocked"):this.calendar_next.eq(e).removeClass(this.namespace+"-blocked")),null!==this.options.min&&(this.current_year[0]<=this.min_year?this.calendar_prev.eq(e).addClass(this.namespace+"-blocked"):this.calendar_prev.eq(e).removeClass(this.namespace+"-blocked"))}else if("range"===this.options.mode){var i=(new Date(this.current_year[0],this.current_month[0],1,0,0,0,0),new Date(this.current_year[1],this.current_month[1],1,0,0,0,0),new Date(this.selected_year[0],this.selected_month[0],1,0,0,0,0)),n=new Date(this.selected_year[1],this.selected_month[1],1,0,0,0,0),a=[];e>0?(this.current_year[e]<=this.selected_year[e-1]?this.calendar_prev.eq(e).addClass(this.namespace+"-blocked"):this.calendar_prev.eq(e).removeClass(this.namespace+"-blocked"),null!==this.options.max&&(this.current_year[e]>=this.max_year?this.calendar_next.eq(e).addClass(this.namespace+"-blocked"):this.calendar_next.eq(e).removeClass(this.namespace+"-blocked"))):(this.current_year[e]===this.selected_year[e+1]?this.calendar_next.eq(e).addClass(this.namespace+"-blocked"):this.calendar_next.eq(e).hasClass(this.namespace+"-blocked")===!0&&this.calendar_next.eq(e).removeClass(this.namespace+"-blocked"),null!==this.options.min&&(this.current_year[e]<=this.min_year?this.calendar_prev.eq(e).addClass(this.namespace+"-blocked"):this.calendar_prev.eq(e).removeClass(this.namespace+"-blocked")))}for(var r="<tr>",h=0;12>h;h++){if(h>0&&0===h%3&&(r+="</tr><tr>"),"single"===this.options.mode){var o="month-"+h;a[h]=new Date(this.current_year[e],h,1,0,0,0,0),Date.parse(a[h])===Date.parse(new Date(this.selected_year[0],this.selected_month[0],1,0,0,0,0))&&(o+=" is-active"),null!==this.options.min&&Date.parse(new Date(this.min_year,this.min_month,1,0,0,0,0))>Date.parse(a[h])&&(o+=" is-untouchable"),null!==this.options.max&&Date.parse(new Date(this.max_year,this.max_month,1,0,0,0,0))<Date.parse(a[h])&&(o+=" is-untouchable")}else if("range"===this.options.mode){var o="month-"+h;a[h]=new Date(this.current_year[e],h,1,0,0,0,0),e>0?Date.parse(a[h])===Date.parse(n)?o+=" is-active":i>a[h]?o+=" is-untouchable":n>a[h]&&a[h]>=i&&(o+=" in-range"):Date.parse(a[h])===Date.parse(i)?o+=" is-active":a[h]>n?o+=" is-untouchable":n>=a[h]&&a[h]>i&&(o+=" in-range"),null!==this.options.min&&Date.parse(new Date(this.min_year,this.min_month,1,0,0,0,0))>Date.parse(a[h])&&(o+=" is-untouchable"),null!==this.options.max&&Date.parse(new Date(this.max_year,this.max_month,1,0,0,0,0))<Date.parse(a[h])&&(o+=" is-untouchable")}r+='<td class="'+o+'">'+t[h]+"</td>"}r+="</tr>",this.monthpicker.eq(e).html(r)},generate_yearpicker:function(e){if(this.manage_header(this.current_year[e]-7+" - "+(this.current_year[e]+4),e),"single"===this.options.mode)null!==this.options.min&&(this.current_year[0]-7<this.min_year?this.calendar_prev.eq(e).addClass(this.namespace+"-blocked"):this.calendar_prev.eq(e).removeClass(this.namespace+"-blocked")),null!==this.options.max&&(this.current_year[0]+4>this.max_year?this.calendar_next.eq(e).addClass(this.namespace+"-blocked"):this.calendar_next.eq(e).removeClass(this.namespace+"-blocked"));else if("range"===this.options.mode){var t=(this.current_date[0].getFullYear(),this.current_date[1].getFullYear(),this.selected_date[0].getFullYear()),s=this.selected_date[1].getFullYear();e>0?(this.current_year[e]-7<=this.selected_year[e-1]?this.calendar_prev.eq(e).addClass(this.namespace+"-blocked"):this.calendar_prev.eq(e).removeClass(this.namespace+"-blocked"),null!==this.options.max&&(this.current_year[e]+4>=this.max_year?this.calendar_next.eq(e).addClass(this.namespace+"-blocked"):this.calendar_next.eq(e).removeClass(this.namespace+"-blocked"))):(this.current_year[e]+4>=this.selected_year[e+1]?this.calendar_next.eq(e).addClass(this.namespace+"-blocked"):this.calendar_next.eq(e).removeClass(this.namespace+"-blocked"),null!==this.options.min&&(this.current_year[e]-7<=this.min_year?this.calendar_prev.eq(e).addClass(this.namespace+"-blocked"):this.calendar_prev.eq(e).removeClass(this.namespace+"-blocked")))}for(var a="<tr>",i=0;12>i;i++){var n=this.current_year[e]-7+i;if(i>0&&0===i%3&&(a+="</tr><tr>"),"single"===this.options.mode){var r="";n===this.selected_year[e]?r="is-active":(r="",null!==this.options.min&&this.min_year>n&&(r="is-untouchable"),null!==this.options.max&&n>this.max_year&&(r="is-untouchable"))}else if("range"===this.options.mode){var r="";e>0?n===s?r="is-active":t>n?r="is-untouchable":s>n&&n>=t&&(r="in-range"):n===t?r="is-active":n>s?r="is-untouchable":s>=n&&n>t&&(r="in-range"),null!==this.options.min&&this.min_year>n&&(r="is-untouchable"),null!==this.options.max&&n>this.max_year&&(r="is-untouchable")}a+='<td class="'+r+'">'+n+"</td>"}a+="</tr>",this.yearpicker.eq(e).html(a)},manage_header:function(e,t){this.calendar.eq(t).find("."+this.namespace+"-caption").html(e)},manage_views:function(e){"days"===this.view[e]?(this.generate_daypicker(e),this.daypicker.eq(e).css("display","block"),this.monthpicker.eq(e).hide(),this.yearpicker.eq(e).hide()):"months"===this.view[e]?(this.generate_monthpicker(e),this.daypicker.eq(e).hide(),this.monthpicker.eq(e).css("display","block"),this.yearpicker.eq(e).hide()):"years"===this.view[e]&&(this.generate_yearpicker(e),this.daypicker.eq(e).hide(),this.monthpicker.eq(e).hide(),this.yearpicker.eq(e).css("display","block"))},prev:function(t){if(e(this).hasClass(this.namespace+"-blocked"))return!1;if("multiple"!==this.options.mode)"days"===this.view[t]?(0>--this.current_month[t]&&(this.current_month[t]=11,this.current_year[t]--),this.set_date(this.current_date[t],"month",this.current_month[t]),this.set_date(this.current_date[t],"year",this.current_year[t])):"months"===this.view[t]?(this.current_year[t]--,this.set_date(this.current_date[t],"year",this.current_year[t])):"years"===this.view[t]&&(this.current_year[t]-=12,this.set_date(this.current_date[t],"year",this.current_year[t])),this.date_update(),this.manage_views(t);else for(var s=0;this.options.calendars>s;s++){if("days"!==this.view[s])return!1;0>--this.current_month[s]&&(this.current_month[s]=11,this.current_year[s]--),this.set_date(this.current_date[s],"month",this.current_month[s]),this.set_date(this.current_date[s],"year",this.current_year[s]),this.date_update(),this.manage_views(s)}},next:function(t){if(e(this).hasClass(this.namespace+"-blocked"))return!1;if("multiple"!==this.options.mode)"days"===this.view[t]?(12===++this.current_month[t]&&(this.current_month[t]=0,this.current_year[t]++),this.set_date(this.current_date[t],"month",this.current_month[t]),this.set_date(this.current_date[t],"year",this.current_year[t])):"months"===this.view[t]?(this.current_year[t]++,this.set_date(this.current_date[t],"year",this.current_year[t])):"years"===this.view[t]&&(this.current_year[t]+=12,this.set_date(this.current_date[t],"year",this.current_year[t])),this.date_update(),this.manage_views(t);else for(var s=0;this.options.calendars>s;s++){if("days"!==this.view[s])return!1;12===++this.current_month[s]&&(this.current_month[s]=0,this.current_year[s]++),this.set_date(this.current_date[s],"month",this.current_month[s]),this.set_date(this.current_date[s],"year",this.current_year[s]),this.date_update(),this.manage_views(s)}},caption:function(e){if("multiple"===this.options.mode)return!1;if("days"===this.view[e])this.view[e]="months";else{if("months"!==this.view[e])return!1;this.view[e]="years"}this.date_update(),this.manage_views(e)},click:function(t){var s=e(t.target).closest("td, span"),a=function(t,s){var a;return e.each(t,function(e,t){t===s&&(a=e)}),a};if(1===s.length){var i=s.parent().parent().parent().parent(),n=s.parent().parent(),r=a(this.calendar,i.get(0)),h=a(this.calendar,n.get(0));switch(s[0].nodeName.toLowerCase()){case"span":switch(s[0].className){case this.namespace+"-caption":this.caption(h);break;case this.namespace+"-prev":this.prev(h);break;case this.namespace+"-next":this.next(h)}break;case"td":var o=s.parent().parent().parent().attr("class"),c=s.hasClass("otherMonthDay"),l=s.hasClass("is-untouchable"),d=this;switch(o){case this.namespace+"-days":if(c!==!1||l!==!1)return!1;var p=parseInt(s.text(),10);if(this.set_date(this.selected_date[r],"day",p),this.set_date(this.current_date[r],"day",p),this.set_date(this.selected_date[r],"month",this.current_month[r]),this.set_date(this.current_date[r],"month",this.current_month[r]),this.set_date(this.selected_date[r],"year",this.current_year[r]),this.set_date(this.current_date[r],"year",this.current_year[r]),this.date_update(),"range"===this.options.mode)0===r?(this.current_date[0]>this.current_date[1]&&(this.set_date(this.current_date[r+1],"month",this.current_month[r]),this.set_date(this.current_date[r+1],"year",this.current_year[r]),this.date_update()),this.manage_views(r+1)):1===r&&(this.current_date[0]>this.current_date[1]&&(this.set_date(this.current_date[r-1],"month",this.current_month[r]),this.set_date(this.current_date[r-1],"year",this.current_year[r]),this.date_update()),this.manage_views(r-1));else if("multiple"===this.options.mode){var m=Date.parse(new Date(this.current_date[r]));e.inArray(m,this.multiple_date)>-1?e.each(this.multiple_date,function(e,t){return t===m?(d.multiple_date.splice(e,1),!1):void 0}):this.multiple_date.push(m),this.manage_views(r-1),this.manage_views(r+1)}this.manage_views(r),this.set_value(r),"single"===this.options.mode&&this.options.alwaysShow===!1&&this.hide();break;case this.namespace+"-months":if(c!==!1||l!==!1)return!1;this.view[r]="days";var u=s.attr("class").match(/month\-([0-9]+)/),_=Number(u[1]);this.set_date(this.current_date[r],"month",_),this.date_update(),this.manage_views(r);break;case this.namespace+"-years":if(c!==!1||l!==!1)return!1;this.view[r]="months";var y=parseInt(s.text(),10);this.set_date(this.current_date[r],"year",y),this.date_update(),this.manage_views(r)}}}}},e.fn.datepicker=function(s){if("string"!=typeof s)return this.each(function(){e.data(this,"datepicker")||e.data(this,"datepicker",new t(this,s))});var a=s,i=arguments.length>1?Array.prototype.slice.call(arguments,1):void 0;if(!/^(getWrap|getInput|getDate)$/.test(a))return this.each(function(){var t=e.data(this,"datepicker");t&&"function"==typeof t[a]&&t[a].apply(t,i)});var n=this.first().data("datepicker");return n&&"function"==typeof n[a]?n[a].apply(n,i):void 0}})(jQuery);