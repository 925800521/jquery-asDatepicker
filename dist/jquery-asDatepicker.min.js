/*! asDatepicker - v0.4.1 - 2014-08-11
* https://github.com/amazingsurge/jquery-asDatepicker
* Copyright (c) 2014 amazingSurge; Licensed MIT */
!function(a,b,c,d){"use strict";var e="asDatepicker",f={firstDayOfWeek:0,mode:"single",limitMode:"default",displayMode:"dropdown",calendars:3,date:"today",keyboard:!0,rangeSeparator:"-",multipleSeparator:",",multipleSize:5,max:null,min:null,container:"body",position:"bottom",alwaysShow:!1,onceClick:!1,selectableYear:[],selectableMonth:[],selectableDay:[],selectableDate:[],disableYear:[],disableMonth:[],disableDay:[],disableDate:[],lang:"en",views:["days"],format:"yyyy/mm/dd",namespace:"calendar",tplWrapper:function(){return'<div class="namespace-wrap"></div>'},tplContent:function(){return'<div class="namespace-content"><div class="namespace-header"><div class="namespace-prev"></div><div class="namespace-caption"></div><div class="namespace-next"></div></div><div class="namespace-days"></div><div class="namespace-months"></div><div class="namespace-years"></div></div>'},onInit:function(){},onReady:function(){},onRender:function(){},onChange:function(){},onBeforeShow:function(){},onShow:function(){},onBeforeHide:function(){},onHide:function(){}},g=a(b),h={},i=0,j=a[e]=function(b,c){this.$el=a(b),this.options=a.extend(!0,{},f,c,this.$el.data()),this.namespace=this.options.namespace;var d=this.$el.wrap(this.options.tplWrapper().replace(/namespace/g,this.namespace)).parent(),e=a('<i class="'+this.namespace+'-icon"></i>');e.appendTo(d),this.$container=a(this.options.container),this._trigger("init"),this._init()};j.LABEL=h,j.localize=function(a,b){h[a]=b},j.localize("en",{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),j.prototype={constructor:j,_init:function(){this.format=this._parseFormat("yyyy-mm-dd"),this.outputFormat=this._parseFormat(this.options.format||"yyyy/mm/dd"),this.mode=this.options.mode,this.focused=0,this.map={},this.pickerHide=!1,this.flag=i++,this.selected=!1,this.showed=!1,this.bound=!1;var b,c=this.options.tplWrapper().replace(/namespace/g,this.namespace),d=this.options.tplContent().replace(/namespace/g,this.namespace),e=a(c);switch(this.mode){case"single":b=1;break;case"range":b=2;break;case"multiple":b=this.options.calendars,this.options.views=["days"]}this.options.calendars=b;for(var f=0;f<this.options.calendars;f++)e.append(d),this.options.views[f]=this.options.views[f]||"days";e.attr("tabindex","0"),"inline"===this.options.displayMode?(this.$el.after(e).addClass(this.namespace+"_hide"),this.picker=e,this.options.alwaysShow=!0,this.picker.addClass(this.namespace+"_show"),this.picker.on({focus:a.proxy(this._focus,this),blur:a.proxy(this._blur,this)})):"dropdown"===this.options.displayMode&&(this.$el.on({focus:a.proxy(this._focus,this),blur:a.proxy(this._blur,this)}),this.picker=e.appendTo(this.options.container),this.picker.addClass(this.namespace+"_absolute")),this.views=this.options.views,this.calendars=this.picker.find("."+this.namespace+"-content"),this.calendarPrevs=this.calendars.find("."+this.namespace+"-prev"),this.calendarCaptions=this.calendars.find("."+this.namespace+"-caption"),this.calendarNexts=this.calendars.find("."+this.namespace+"-next"),this.daypickers=this.calendars.find("."+this.namespace+"-days"),this.monthpickers=this.calendars.find("."+this.namespace+"-months"),this.yearpickers=this.calendars.find("."+this.namespace+"-years"),this._initDate();for(var g=0;g<this.options.calendars;g++)this._manageViews(g);this.options.alwaysShow===!0?this.show():(this.showed=!0,this.hide()),this._setValue(),this._trigger("ready")},_initDate:function(){var a="today"===this.options.data?new Date:this._parseDate(this.options.date,this.format);this.currentDate=[new Date(a)],"multiple"===this.mode?(this.selectedDate=[],this.focusDate=new Date(a)):(this.selectedDate=[new Date(a)],this.focusDate=[new Date(a)]),this.currentDay=[],this.currentMonth=[],this.currentYear=[],this.currentMonthDate=[],this.currentYearDate=[],this.selectedDay=[],this.selectedMonth=[],this.selectedYear=[],this.selectedMonthDate=[],this.selectedYearDate=[],null!==this.options.max&&(this.maxDate=this._parseDate(this.options.max,this.format),this.maxMonth=this.maxDate.getMonth(),this.maxYear=this.maxDate.getFullYear()),null!==this.options.min&&(this.minDate=this._parseDate(this.options.min,this.format),this.minMonth=this.minDate.getMonth(),this.minYear=this.minDate.getFullYear());for(var b=0;b<this.options.calendars;b++)this.currentDate[b]=this.currentDate[b]||new Date(a),"multiple"===this.mode?this._setDate(this.currentDate[b],"month",this.currentDate[b].getMonth()+b):(this.selectedDate[b]=this.selectedDate[b]||new Date(a),this.selectedDate[b].setHours(0,0,0,0),this.focusDate[b]=this.focusDate[b]||new Date(a),this.focusDate[b].setHours(0,0,0,0)),this._updateDate(b);switch(this.selectableDate=this.options.selectableDate.length>0?!0:!1,this.disableDate=this.options.disableDate.length>0?!0:!1,this.yearSelectable=this.options.selectableYear.length>0?!0:!1,this.monthSelectable=this.options.selectableMonth.length>0?!0:!1,this.daySelectable=this.options.selectableDay.length>0?!0:!1,this.yearDisable=this.options.disableYear.length>0?!0:!1,this.monthDisable=this.options.disableMonth.length>0?!0:!1,this.dayDisable=this.options.disableDay.length>0?!0:!1,this.options.limitMode){case"section":this.options.selectableYear.length>0&&(this.selectableYear=!0),this.yearSection=this.yearSelectable===!0?this._parseAble(this.options.selectableYear):this.yearDisable===!0?this._parseAble(this.options.disableYear):null,this.monthSection=this.monthSelectable===!0?this._parseAble(this.options.selectableMonth):this.monthDisable===!0?this._parseAble(this.options.disableMonth):null,this.daySection=this.daySelectable===!0?this._parseAble(this.options.selectableDay):this.dayDisable===!0?this._parseAble(this.options.disableDay):null;break;case"array":this.arrayRange=this.selectableDate===!0?this._parseAbleDate(this.options.selectableDate,this.format):this.disableDate===!0?this._parseAbleDate(this.options.disableDate,this.format):null,this.arrayRangeMonth=this._changeDateLevel("month",this.arrayRange),this.arrayRangeYear=this._changeDateLevel("year",this.arrayRange)}},_changeDateLevel:function(b,c){var e,f=[];return a.each(c,function(a,c){if(c.length===d)switch(e="",b){case"month":e=new Date(c.getFullYear(),c.getMonth(),1,0,0,0,0);break;case"year":e=new Date(c.getFullYear(),0,1,0,0,0,0)}else if(2===c.length)switch(e=[],b){case"month":e[0]=new Date(c[0].getFullYear(),c[0].getMonth(),1,0,0,0,0),e[1]=new Date(c[1].getFullYear(),c[1].getMonth(),1,0,0,0,0);break;case"year":e[0]=new Date(c[0].getFullYear(),0,1,0,0,0,0),e[1]=new Date(c[1].getFullYear(),0,1,0,0,0,0)}f.push(e)}),f},_updateDate:function(a){this.currentDate[a].setDate(1),this.currentDate[a].setHours(0,0,0,0),this.currentDay[a]=this.currentDate[a].getDate(),this.currentMonth[a]=this.currentDate[a].getMonth(),this.currentYear[a]=this.currentDate[a].getFullYear(),this.currentMonthDate[a]=new Date(this.currentYear[a],this.currentMonth[a],1,0,0,0,0),this.currentYearDate[a]=new Date(this.currentYear[a],0,1,0,0,0,0),"multiple"!==this.mode&&(this.selectedDay[a]=this.selectedDate[a].getDate(),this.selectedMonth[a]=this.selectedDate[a].getMonth(),this.selectedYear[a]=this.selectedDate[a].getFullYear(),this.selectedMonthDate[a]=new Date(this.selectedYear[a],this.selectedMonth[a],1,0,0,0,0),this.selectedYearDate[a]=new Date(this.selectedYear[a],0,1,0,0,0,0))},_inArray:function(b,c){return-1===a.inArray(b,c)?!1:!0},_stringSeparate:function(a,b){var c=new RegExp("[.\\"+b+"\\s].*?"),d=a.match(c),e=a.split(d);return e},_parseHtmlString:function(a,b){var c=[],d=j.defaults;if("object"==typeof d[a]){for(var e,f=this._stringSeparate(b,","),g=0;g<f.length;g++)e=this._stringSeparate(f[g],">"),e=e.length>1?{from:e[0],to:e[1]}:e[0],c.push(e);return c}return b},_setDate:function(a,b,c){if("object"==typeof b)for(var d in b)switch(d){case"day":a.setDate(b[d]);break;case"month":a.setMonth(b[d]);break;case"year":a.setYear(b[d])}else switch(b){case"day":a.setDate(c);break;case"month":a.setMonth(c);break;case"year":a.setYear(c)}},_parseFormat:function(a){var b=a.match(/[.\/\-\s].*?/),c=a.split(/\W+/)||c;if(!c||0===c.length)throw new Error("Invalid date format.");return{separator:b,parts:c}},_formatDate:function(a,b){var c={d:a.getDate(),m:a.getMonth()+1,yy:a.getFullYear().toString().substring(2),yyyy:a.getFullYear()};c.dd=(c.d<10?"0":"")+c.d,c.mm=(c.m<10?"0":"")+c.m,a=[];for(var d=0,e=b.parts.length;e>d;d++)a.push(c[b.parts[d]]);return a.join(b.separator)},_parseDate:function(a,b){var c=new Date,d=c.getDate();switch(typeof a){case"string":if(a.length<5)c.setHours(0,0,0,0),c.setDate(d+Number(a));else{var e,f=a.split(b.separator)||f;if(c.setHours(0,0,0,0),f.length===b.parts.length)for(var g=0,h=b.parts.length;h>g;g++){if(e=parseInt(f[g],10)||1,"1"===e)return;switch(b.parts[g]){case"dd":case"d":c.setDate(e);break;case"mm":case"m":c.setMonth(e-1,1);break;case"yy":c.setFullYear(2e3+e);break;case"yyyy":c.setFullYear(e)}}}break;case"number":c.setHours(0,0,0,0),c.setDate(d+a)}return c},_parseAbleDate:function(a,b){for(var c=[],d=0,e=0;e<a.length;e++)if("string"==typeof a[e])c[d++]=this._parseDate(a[e],b);else if("object"==typeof a[e]){var f,g,h=a[e];for(var i in h)switch(i){case"from":f=h[i];break;case"to":g=h[i]}c[d++]=[this._parseDate(f,b),this._parseDate(g,b)]}return c},_parseAble:function(a){for(var b=[],c=0,d=0;d<a.length;d++)if("number"==typeof a[d])b[c++]=a[d];else if("string"==typeof a[d])b[c++]=Number(a[d]);else if("object"==typeof a[d]){var e,f,g=a[d];for(var h in g)switch(h){case"from":e=Number(g[h]);break;case"to":f=Number(g[h])}for(var i=e;f>=i;i++)b[c++]=i}return b},_position:function(){var a,b,d=this.picker.outerHeight(),e=this.picker.outerWidth(),f=this.$container.height()||c.innerHeight,g=this.$el.offset().top-this.$container.offset().top,h=this.$el.offset().left-this.$container.offset().left,i=this.$el.outerHeight(),j=this.$el.outerWidth(),k=this.$container.scrollTop()||0,l=this.$container.scrollLeft()||0,m=this.options.position;switch(m){case"bottom":case"right":case"left":g+i+d>f&&("bottom"===m?m="top":(m="left")?m="leftTop":(m="right")&&(m="rightTop"));break;case"top":case"rightTop":case"leftTop":0>g-d&&("top"===m?m="bottom":(m="leftTop")?m="left":(m="rightTop")&&(m="right"))}switch(m){case"top":a=h+l,b=g-d+k;break;case"right":a=h+j+l,b=g+k;break;case"bottom":a=h+l,b=g+i+k;break;case"left":a=h-e+l,b=g+k;break;case"rightTop":a=h+j+l,b=g-d+i+k;break;case"leftTop":a=h-e+l,b=g-d+i+k}this.picker.css({left:a,top:b})},_setPoint:function(a,b,c,d){var e=b;switch(a){case"=":c===d&&(e=!0);break;case"<":d>c&&(e=!0);break;case">":c>d&&(e=!0)}return e},_setSection:function(a,b,c,d){var e=a,f=Date.parse(b),g=Date.parse(c),h=Date.parse(d);return f>=g&&h>=f&&(e=!0),e},_setRange:function(b,c,e,f,g){var h=e,i=this;return"section"===b?h=this._inArray(f,g):"array"===b&&a.each(g,function(a,b){switch(b.length){case d:Date.parse(f)===Date.parse(b)&&(h=!0);break;case 2:h=i._setSection(h,f,b[0],b[1])}}),h},_judgeLock:function(a){var b,c,d=!1,e=!1;switch(this.mode){case"range":if(0===a){switch(this.views[a]){case"days":b=Date.parse(this.currentDate[a]),c=Date.parse(this.selectedMonthDate[1]);break;case"months":b=Date.parse(this.currentYearDate[a]),c=Date.parse(this.selectedYearDate[1]);break;case"years":b=new Date(this.currentYearDate[a]).setFullYear(this.currentYear[a]+4),c=Date.parse(this.selectedYearDate[1])}e=!this._setPoint("<",e,b,c)}else{switch(this.views[a]){case"days":b=Date.parse(this.currentDate[a]),c=Date.parse(this.selectedMonthDate[0]);break;case"months":b=Date.parse(this.currentYearDate[a]),c=Date.parse(this.selectedYearDate[0]);break;case"years":b=new Date(this.currentYearDate[a]).setFullYear(this.currentYear[a]+4),c=Date.parse(this.selectedYearDate[0])}d=!this._setPoint(">",d,b,c)}break;case"multiple":0===a?e=!0:d=a===this.options.calendars-1?!0:e=!0}d===!0?this.calendarPrevs.eq(a).addClass(this.namespace+"_blocked"):this.calendarPrevs.eq(a).removeClass(this.namespace+"_blocked"),e===!0?this.calendarNexts.eq(a).addClass(this.namespace+"_blocked"):this.calendarNexts.eq(a).removeClass(this.namespace+"_blocked")},_judgeRange:function(b,c,e){var f,g,h=c,i=this.options.limitMode,j=this;if("section"===i){switch(b){case"days":f=this.daySection,g=e.getDay();break;case"months":f=this.monthSection,g=e.getMonth();break;case"years":f=this.yearSection,g=e.getFullYear()}h=this._inArray(g,f)}else if("array"===i){switch(b){case"days":f=this.arrayRange;break;case"months":f=this.arrayRangeMonth;break;case"years":f=this.arrayRangeYear}a.each(f,function(a,b){switch(b.length){case d:Date.parse(e)===Date.parse(b)&&(h=!0);break;case 2:h=j._setSection(h,e,b[0],b[1])}})}return h},_judgeStatus:function(a,b,c,d,e,f){var g=d[0],h=d[1],i=d[2];switch(c){case"single":h=this._setPoint("=",h,Date.parse(e),Date.parse(f[a]));break;case"range":h=this._setPoint("=",h,Date.parse(e),Date.parse(f[a])),i=this._setSection(i,e,f[0],f[1]),0===a?g=this._setPoint(">",g,Date.parse(e),Date.parse(f[1])):1===a&&(g=this._setPoint("<",g,Date.parse(e),Date.parse(f[0])));break;case"multiple":for(var j=0;j<this.selectedDate.length;j++)Date.parse(e)===f[j]&&(h=!0)}return d=[g,h,i]},_renderStatus:function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f="";return e===!0?f=" "+this.namespace+"_untouchable":(b===!0&&(f=" "+this.namespace+"_untouchable"),d===!0&&(f+=" "+this.namespace+"_inRange")),c===!0&&(f+=" "+this.namespace+"_active"),f},_manageViews:function(a){switch(this.views[a]){case"days":this._generateDaypicker(a),this.calendars.eq(a).addClass(this.namespace+"_days"),this.calendars.eq(a).removeClass(this.namespace+"_months"),this.calendars.eq(a).removeClass(this.namespace+"_years");break;case"months":this._generateMonthpicker(a),this.calendars.eq(a).removeClass(this.namespace+"_days"),this.calendars.eq(a).addClass(this.namespace+"_months"),this.calendars.eq(a).removeClass(this.namespace+"_years");break;case"years":this._generateYearpicker(a),this.calendars.eq(a).removeClass(this.namespace+"_days"),this.calendars.eq(a).removeClass(this.namespace+"_months"),this.calendars.eq(a).addClass(this.namespace+"_years")}},_generateDaypicker:function(a){this._generateHeader(a,h[this.options.lang].months[this.currentMonth[a]]+" "+this.currentYear[a]),this.daypickers.eq(a).html(this._buildDays(a))},_generateMonthpicker:function(a){this._generateHeader(a,this.currentYear[a]),this.monthpickers.eq(a).html(this._buildMonths(a))},_generateYearpicker:function(a){this._generateHeader(a,this.currentYear[a]-7+this.options.rangeSeparator+(this.currentYear[a]+4)),this.yearpickers.eq(a).html(this._buildYears(a))},_generateHeader:function(a,b){this.calendarCaptions.eq(a).html(b),this._judgeLock(a)},_buildDays:function(a){var b,c,d,e,f,g,i,j=this.currentYear[a],k=this.currentMonth[a],l=new Date(j,k+1,0).getDate(),m=new Date(j,k,1).getDay(),n=new Date(j,k,0).getDate(),o=m-this.options.firstDayOfWeek,p='<div class="'+this.namespace+'-head">',q=[],r=[];o=0>o?7+o:o;for(var s=0;7>s;s++)p+="<span>"+h[this.options.lang].daysShort[s]+"</span>";p+='</div><div class="'+this.namespace+'-body"><div class="'+this.namespace+'-row">';for(var t=0;42>t;t++)b=t-o+1,d=!1,e=!1,c=!1,f=!1,q=[c,d,e,f],g=0,i="",t>0&&t%7===0&&(p+='</div><div class="'+this.namespace+'-row">'),o>t?(i=this.namespace+"_otherMonth",g=n-o+t+1,r[t]=new Date(j,k-1,g,0,0,0,0)):t>l+o-1?(i=this.namespace+"_otherMonth",g=b-l,r[t]=new Date(j,k+1,g,0,0,0,0)):(r[t]=new Date(j,k,b,0,0,0,0),g=b,"multiple"===this.mode?Date.parse(r[t])===Date.parse(this.focusDate)&&(i+=" "+this.namespace+"_focus"):Date.parse(r[t])===Date.parse(this.focusDate[a])&&(i+=" "+this.namespace+"_focus")),q=this._judgeStatus(a,"days",this.mode,q,r[t],this.selectedDate),q[3]=this._judgeRange("days",q[3],r[t]),("section"===this.options.limitMode&&this.daySelectable===!0||"array"===this.options.limitMode&&this.selectableDate===!0)&&(q[3]=!q[3]),i+=this._renderStatus(q),p+='<span class="'+i+'">'+g+"</span>";return p+="</div></div>"},_buildMonths:function(a){var b,c,d,e,f,g=this.currentYear[a],i="",j=h[this.options.lang].monthsShort,k=this.focusDate[a],l=[],m=[];i+='<div class="'+this.namespace+'-row">';for(var n=0;12>n;n++)c=!1,d=!1,e=!1,f=!1,m=[e,c,d,f],b="",n>0&&n%3===0&&(i+='</div><div class="'+this.namespace+'-row">'),l[n]=new Date(g,n,1,0,0,0,0),m=this._judgeStatus(a,"months",this.mode,m,l[n],this.selectedMonthDate),m[3]=this._judgeRange("months",m[3],l[n]),("section"===this.options.limitMode&&this.monthSelectable===!0||"array"===this.options.limitMode&&this.selectableDate===!0)&&(m[3]=!m[3]),Date.parse(l[n])===Date.parse(new Date(k.getFullYear(),k.getMonth(),1,0,0,0,0))&&(b+=" "+this.namespace+"_focus"),b+=this._renderStatus(m),i+='<span class="month-'+n+" "+b+'">'+j[n]+"</span>";return i+="</div>"},_buildYears:function(a){var b,c,d,e,f,g=this.currentYear[a],h="",i=0,j=[],k=this.focusDate[a],l=[];h+='<div class="'+this.namespace+'-row">';for(var m=0;12>m;m++)c=!1,d=!1,e=!1,f=!1,l=[e,c,d,f],b="",i=g-7+m,m>0&&m%3===0&&(h+='</div><div class="'+this.namespace+'-row">'),j[m]=new Date(i,0,1,0,0,0,0),l=this._judgeStatus(a,"years",this.mode,l,j[m],this.selectedYearDate),l[3]=this._judgeRange("years",l[3],j[m]),("section"===this.options.limitMode&&this.yearSelectable===!0||"array"===this.options.limitMode&&this.selectableDate===!0)&&(l[3]=!l[3]),Date.parse(j[m])===Date.parse(new Date(k.getFullYear(),0,1,0,0,0,0))&&(b+=" "+this.namespace+"_focus"),b+=this._renderStatus(l),h+='<span class="'+b+'">'+i+"</span>";return h+="</div>"},_click:function(b){if(0===a(b.target).closest(this.picker).length&&0===a(b.target).closest(this.$el).length&&this.options.alwaysShow===!1)this.hide();else if(1!==a(b.target).closest(this.$el).length&&1===a(b.target).closest(this.picker).length){var c=a(b.target).closest("span, div");if(1===c.length){var d=c.parents("."+this.namespace+"-content").index();switch(c[0].className){case this.namespace+"-caption":this._changeView("caption",d),this._manageViews(d);break;case this.namespace+"-prev":this.prev(d);break;case this.namespace+"-next":this.next(d);break;default:if(c.hasClass(this.namespace+"_otherMonth")||c.hasClass(this.namespace+"_untouchable")||c.hasClass(this.namespace+"_blocked")||1===c.parents("."+this.namespace+"-head").length)return!1;this._changeValue(c,d),"days"===this.views[d]&&"single"===this.mode&&(this.selected=!0),this._changeView("content",d),this._updateDate(d),"range"===this.mode?(this._manageViews(0),this._manageViews(1)):"multiple"===this.mode?(this._manageViews(d-1),this._manageViews(d),this._manageViews(d+1)):"single"===this.mode&&this._manageViews(d),this._setValue()}}this.selected===!0&&this.options.alwaysShow===!1&&"single"===this.mode&&this.options.onceClick===!0?this.hide():"dropdown"===this.options.displayMode&&this.$el.focus()}},_changeView:function(a,b){switch(a){case"caption":if("multiple"===this.options.mode)return!1;if("days"===this.views[b])this.views[b]="months";else{if("months"!==this.views[b])return!1;this.views[b]="years"}break;case"content":if("years"===this.views[b])this.views[b]="months";else{if("months"!==this.views[b])return!1;this.views[b]="days"}break;case"higher":if("multiple"===this.options.mode)return!1;if("days"===this.views[b])this.views[b]="months";else{if("months"!==this.views[b])return!1;this.views[b]="years"}break;case"lower":if("multiple"===this.options.mode)return!1;if("years"===this.views[b])this.views[b]="months";else{if("months"!==this.views[b])return!1;this.views[b]="days"}}},_changeValue:function(b,c){var d="",e="",f=this;switch(this.views[c]){case"years":d=parseInt(b.text(),10),this.currentDate[c].setYear(d);break;case"months":d=Number(b.attr("class").match(/month\-([0-9]+)/)[1]),this.currentDate[c].setMonth(d);break;case"days":switch(d=parseInt(b.text(),10),e=new Date(this.currentYear[c],this.currentMonth[c],d,0,0,0,0),this.options.mode){case"single":case"range":this.selectedDate[c]=e;break;case"multiple":var g=Date.parse(e);a.inArray(g,this.selectedDate)>-1?a.each(this.selectedDate,function(a,b){return b===g?(f.selectedDate.splice(a,1),!1):void 0}):this.selectedDate.length<this.options.multipleSize&&this.selectedDate.push(g)}}},_setValue:function(){switch(this.mode){case"single":var a=this._formatDate(this.selectedDate[0],this.outputFormat);this.$el.val(a);break;case"range":var b=this._formatDate(this.selectedDate[0],this.outputFormat),c=this._formatDate(this.selectedDate[1],this.outputFormat);this.$el.val(b+this.options.rangeSeparator+c);break;case"multiple":for(var d,e="",f=0;f<this.selectedDate.length;f++)d=this._formatDate(new Date(this.selectedDate[f]),this.outputFormat),e+=0===e.length?d:this.options.multipleSeparator+d;this.$el.val(e)}this._trigger("change"),this.oldValue=this.$el.val()},_focus:function(){"dropdown"===this.options.displayMode&&this.showed===!1&&this.show(),this.options.keyboard&&this._keyboard.init(this)},_blur:function(){return"dropdown"===this.options.displayMode&&this.pickerHide===!0&&(this.hide(),this.pickerHide=!1),this.options.keyboard&&this._keyboard.destroy(this),!1},_trigger:function(a){this.$el.trigger(e+"::"+a,this),a=a.replace(/\b\w+\b/g,function(a){return a.substring(0,1).toUpperCase()+a.substring(1)});var b="on"+a,c=arguments.length>1?Array.prototype.slice.call(arguments,1):d;"function"==typeof this.options[b]&&this.options[b].apply(this,c)},show:function(){var a=this;return"inline"===this.options.displayMode?(this._trigger("beforeShow"),this.picker.on("click.picker",function(b){a._click.call(a,b)})):this.showed===!1&&(this._trigger("beforeShow"),this.picker.removeClass(this.namespace+"_hide"),this.picker.addClass(this.namespace+"_show"),this._position(),this.showed=!0,g.on("click."+this.flag,function(b){a._click.call(a,b)})),this._trigger("show"),this},hide:function(){return this.showed===!0&&(this._trigger("beforeHide"),this.selected=!1,this.picker.removeClass(this.namespace+"_show"),this.picker.addClass(this.namespace+"_hide"),this.showed=!1,g.off("click."+this.flag),this._trigger("hide")),this},set:function(a,b){var c=this._parseDate(a,this.format),e=b?this._parseDate(b,this.format):d;switch(this.options.mode){case"single":this.currentDate[0]=new Date(c),this.selectedDate[0]=new Date(c);break;case"range":this.currentDate[0]=new Date(c),this.selectedDate[0]=new Date(c),e&&(this.currentDate[1]=new Date(e),this.selectedDate[1]=new Date(e));break;case"multiple":}for(var f=0;f<this.options.calendars;f++)this._changeView("content",f),this._updateDate(f),this._manageViews(f);this._setValue()},prev:function(a,b){var c=this.currentDate[a];switch(this.views[a]){case"days":var d;if("multiple"===this.mode){if(b)if(0===this.focused)for(var e=0;e<this.options.calendars;e++)this.currentDate[e].setMonth(this.currentMonth[e]-1),this._updateDate(e),this._manageViews(e);else--this.focused,this._manageViews(a),this._manageViews(a-1);else{d=new Date(c.getFullYear(),c.getMonth(),0).getDate(),this.focusDate.getDate()>d&&this.focusDate.setDate(d),this.focusDate.setMonth(this.focusDate.getMonth()-1);for(var f=0;f<this.options.calendars;f++)this.currentDate[f].setMonth(this.currentMonth[f]-1),this._updateDate(f),this._manageViews(f)}return!1}c.setMonth(this.currentMonth[a]-1),b&&(d=new Date(c.getFullYear(),c.getMonth(),0).getDate(),this.focusDate[a].getDate()>d&&this.focusDate[a].setDate(d),this.focusDate[a]=new Date(c.getFullYear(),c.getMonth(),this.focusDate[a].getDate(),0,0,0,0));break;case"months":c.setYear(this.currentYear[a]-1),b&&(this.focusDate[a]=new Date(c.getFullYear(),this.focusDate[a].getMonth(),this.focusDate[a].getDate(),0,0,0,0));break;case"years":c.setYear(this.currentYear[a]-12)}this._updateDate(a),this._manageViews(a)},next:function(a,b){var c=this.currentDate[a];switch(this.views[a]){case"days":var d;if("multiple"===this.mode){if(b)if(this.focused===this.options.calendars-1)for(var e=0;e<this.options.calendars;e++)this.currentDate[e].setMonth(this.currentMonth[e]+1),this._updateDate(e),this._manageViews(e);else++this.focused,this._manageViews(a),this._manageViews(a+1);else{d=new Date(c.getFullYear(),c.getMonth()+2,0).getDate(),this.focusDate.getDate()>d&&this.focusDate.setDate(d),this.focusDate.setMonth(this.focusDate.getMonth()+1);for(var f=0;f<this.options.calendars;f++)this.currentDate[f].setMonth(this.currentMonth[f]+1),this._updateDate(f),this._manageViews(f)}return!1}c.setMonth(this.currentMonth[a]+1),b&&(d=new Date(c.getFullYear(),c.getMonth()+1,0).getDate(),this.focusDate[a].getDate()>d&&this.focusDate[a].setDate(d),this.focusDate[a]=new Date(c.getFullYear(),c.getMonth(),this.focusDate[a].getDate(),0,0,0,0));break;case"months":c.setYear(this.currentYear[a]+1),b&&(this.focusDate[a]=new Date(c.getFullYear(),this.focusDate[a].getMonth(),this.focusDate[a].getDate(),0,0,0,0));break;case"years":c.setYear(this.currentYear[a]+12)}this._updateDate(a),this._manageViews(a)},multipleClear:function(){this.selectedDate=[];for(var a=0;a<this.options.calendars;a++)this._manageViews(a);this._setValue()},getWrap:function(){return this.picker},getInput:function(){return this.$el},getDate:function(a){if(a===d)return this.selectedDate;for(var b=this._parseFormat(a),c=[],e=0;e<this.selectedDate.length;e++)c[e]=this._formatDate(this.selectedDate[e],b);return c},destroy:function(){this.$el.removeData("asDatepicker"),this.picker.remove(),"inline"===this.options.displayMode?this.picker.off("click.picke"):g.off("click."+this.flag),this.$el.off("focus"),this.$el.off("blur")},update:function(a){if("undefined"!=typeof a)for(var b in a)this.options[b]=a[b];this.destroy(),this._init()},_keyboard:{init:function(a){this.attach(a,this.gather(a))},destroy:function(a){"dropdown"===a.options.displayMode?a.$el.off("keydown.dropdown"):a.picker.off("keydown.inline"),a.bound=!1},keys:function(){return{LEFT:37,UP:38,RIGHT:39,DOWN:40,ENTER:13,ESC:27,CTRL:17,ALT:18}},prevDate:function(){var a=this.focused,b="multiple"===this.mode?this.focusDate:this.focusDate[a];switch(this.views[a]){case"days":b.setDate(b.getDate()-1),new Date(b).setDate(1)===new Date(this.currentMonthDate[a]).setMonth(this.currentDate[a].getMonth()-1)?this.prev(a,!0):this._manageViews(a);break;case"months":b.setMonth(b.getMonth()-1),Date.parse(new Date(b.getFullYear(),0,1,0,0,0,0))===new Date(this.currentYearDate[a]).setFullYear(this.currentDate[a].getFullYear()-1)?this.prev(a):this._manageViews(a);break;case"years":b.setFullYear(b.getFullYear()-1),b.getFullYear()===this.currentYear[a]-8?this.prev(a):this._manageViews(a)}},nextDate:function(){var a=this.focused,b="multiple"===this.mode?this.focusDate:this.focusDate[a];switch(this.views[a]){case"days":b.setDate(b.getDate()+1),new Date(b).setDate(1)===new Date(this.currentMonthDate[a]).setMonth(this.currentDate[a].getMonth()+1)?this.next(a,!0):this._manageViews(a);break;case"months":b.setMonth(b.getMonth()+1),Date.parse(new Date(b.getFullYear(),0,1,0,0,0,0))===new Date(this.currentYearDate[a]).setFullYear(this.currentDate[a].getFullYear()+1)?this.next(a):this._manageViews(a);break;case"years":b.setFullYear(b.getFullYear()+1),b.getFullYear()===this.currentYear[a]+5?this.next(a):this._manageViews(a)}},upLine:function(){var a=this.focused,b="multiple"===this.mode?this.focusDate:this.focusDate[a];switch(this.views[a]){case"days":b.setDate(b.getDate()-7),new Date(b).setDate(1)===new Date(this.currentMonthDate[a]).setMonth(this.currentDate[a].getMonth()-1)?this.prev(a,!0):this._manageViews(a);break;case"months":b.setMonth(b.getMonth()-3),Date.parse(new Date(b.getFullYear(),0,1,0,0,0,0))===new Date(this.currentYearDate[a]).setFullYear(this.currentDate[a].getFullYear()-1)?this.prev(a):this._manageViews(a);break;case"years":b.setFullYear(b.getFullYear()-3),b.getFullYear()<=this.currentYear[a]-8?this.prev(a):this._manageViews(a)}},downLine:function(){var a=this.focused,b="multiple"===this.mode?this.focusDate:this.focusDate[a];switch(this.views[a]){case"days":b.setDate(b.getDate()+7),new Date(b).setDate(1)===new Date(this.currentMonthDate[a]).setMonth(this.currentDate[a].getMonth()+1)?this.next(a,!0):this._manageViews(a);break;case"months":b.setMonth(b.getMonth()+3),Date.parse(new Date(b.getFullYear(),0,1,0,0,0,0))===new Date(this.currentYearDate[a]).setFullYear(this.currentDate[a].getFullYear()+1)?this.next(a):this._manageViews(a);break;case"years":b.setFullYear(b.getFullYear()+3),b.getFullYear()>=this.currentYear[a]+5?this.next(a):this._manageViews(a)}},prevPage:function(){if("multiple"===this.mode)this.prev(this.focused);else{if(this.calendarPrevs.eq(this.focused).hasClass(this.namespace+"-blocked"))return!1;this.prev(this.focused,!0)}},nextPage:function(){if("multiple"===this.mode)this.next(this.focused);else{if(this.calendarNexts.eq(this.focused).hasClass(this.namespace+"-blocked"))return!1;this.next(this.focused,!0)}},higherView:function(){if("multiple"===this.mode)return!1;var a=this.focused;this._changeView("higher",a),this._manageViews(a)},lowerView:function(){if("multiple"===this.mode)return!1;var a=this.focused;this._changeView("lower",a),this._manageViews(a)},prevCalendar:function(){if("multiple"===this.mode)return!1;var a=this.calendars.length;--this.focused<0&&(this.focused=a)},nextCalendar:function(){if("multiple"===this.mode)return!1;var a=this.calendars.length;++this.focused>=a&&(this.focused=0)},updateValue:function(b){var c=b.focused,d="multiple"===b.mode?b.focusDate:b.focusDate[c];if(b.calendars.eq(c).find("."+this.namespace+"_focus").hasClass(this.namespace+"_untouchable"))return!1;switch(b.views[c]){case"days":switch(b.options.mode){case"single":case"range":b.selectedDate[c]=new Date(d);break;case"multiple":var e=Date.parse(new Date(d));a.inArray(e,b.selectedDate)>-1?a.each(b.selectedDate,function(a,c){return c===e?(b.selectedDate.splice(a,1),!1):void 0}):b.selectedDate.push(e)}break;case"months":b.currentDate[c].setMonth(d.getMonth()),b.views[c]="days";break;case"years":b.currentDate[c].setFullYear(d.getFullYear()),b.views[c]="months"}b._updateDate(c),"range"===b.mode?(b._manageViews(0),b._manageViews(1)):"multiple"===b.mode?(b._manageViews(c-1),b._manageViews(c),b._manageViews(c+1)):b._manageViews(c),b._setValue()},enter:function(){var b,c=this.$el.val(),d=this;if(c===this.oldValue||""===this.oldValue)this._keyboard.updateValue(this);else{var e;switch(this.mode){case"single":var f=Date.parse(c);f&&(this.selectedDate[0]=new Date(f),this.currentDate[0]=new Date(this.selectedDate[0]),this._updateDate(0),this._manageViews(0));break;case"range":e=this._stringSeparate(c,this.options.rangeSeparator);var g=Date.parse(e[0]),h=Date.parse(e[1]);if(2===e.length?(b=!0,g&&h?g>h&&(b=!1):b=!1):b=!1,b===!0){this.selectedDate[0]=new Date(g),this.selectedDate[1]=new Date(h);for(var i=0;2>i;i++)this.currentDate[i]=new Date(this.selectedDate[i]),this._updateDate(i),this._manageViews(i)}else this._keyboard.updateValue(this);break;case"multiple":e=this._stringSeparate(c,this.options.multipleSeparator);var j=[];b=!0;for(var k=0;k<e.length;k++)j.push(Date.parse(e[k])),Date.parse(e[k])||(b=!1);if(b===!0){this.selectedDate=[];for(var l=0;l<j.length;l++)a.inArray(j[l],this.selectedDate)>-1?a.each(this.selectedDate,function(a,b){return b===j[l]?(d.selectedDate.splice(a,1),!1):void 0}):this.selectedDate.push(j[l]);for(var m=0;m<this.options.calendars;m++)this._updateDate(m),this._manageViews(m)}else this._keyboard.updateValue(this)}}this._setValue()},esc:function(){this.$el.blur(),this.hide()},tab:function(){this.pickerHide=!0},gather:function(b){return{left:a.proxy(this.prevDate,b),up:a.proxy(this.upLine,b),right:a.proxy(this.nextDate,b),down:a.proxy(this.downLine,b),ctrl_left:a.proxy(this.prevPage,b),ctrl_up:a.proxy(this.higherView,b),ctrl_right:a.proxy(this.nextPage,b),ctrl_down:a.proxy(this.lowerView,b),alt_left:a.proxy(this.prevCalendar,b),alt_right:a.proxy(this.nextCalendar,b),enter:a.proxy(this.enter,b),esc:a.proxy(this.esc,b)}},press:function(a){var b,c=a.keyCode||a.which;return a.ctrlKey?(a.preventDefault(),b=this.map[17]):a.altKey?(a.preventDefault(),b=this.map[18]):b=this.map,9===c&&this._keyboard.tab.call(this),c in b&&"function"==typeof b[c]?(a.preventDefault(),b[c].call(this)):void 0
},attach:function(a,b){var c,e=this;for(c in b)if(b.hasOwnProperty(c)){var f=[],g=a._stringSeparate(c,"_"),h=g.length;if(1===h)f[0]=g[0].toUpperCase(),a.map[this.keys()[f[0]]]=b[c];else for(var i=0;i<g.length;i++)f[i]=g[i].toUpperCase(),0===i?a.map[this.keys()[f[0]]]===d&&(a.map[this.keys()[f[0]]]={}):a.map[this.keys()[f[0]]][this.keys()[f[i]]]=b[c]}a.bound||(a.bound=!0,"dropdown"===a.options.displayMode?a.$el.on("keydown.dropdown",function(b){e.press.call(a,b)}):a.picker.on("keydown.inline",function(b){e.press.call(a,b)}))}}},j.defaults=f,a.fn[e]=function(b){if("string"!=typeof b)return this.each(function(){a.data(this,e)||a.data(this,e,new j(this,b))});var c=b,f=arguments.length>1?Array.prototype.slice.call(arguments,1):d;if(/^\_/.test(c))return!1;if(!/^(getWrap|getInput|getDate)$/.test(c))return this.each(function(){var b=a.data(this,e);b&&"function"==typeof b[c]&&b[c].apply(b,f)});var g=this.first().data(e);return g&&"function"==typeof g[c]?g[c].apply(g,f):void 0}}(jQuery,document,window);